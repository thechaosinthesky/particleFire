var ParticleFire={App:{},init:function(){},initControlPanel:function(){this.App.profiles=new ParticleFire.Collections.Profile([]),this.App.controlPanel=new ParticleFire.Views.ControlPanel({el:"#profiles"}),this.App.router=new ParticleFire.Routers.ControlPanel({})},login:function(a){},properties:{},Templates:{},Models:{},Collections:{},Views:{},Routers:{}};_.mixin({renderIfDefined:function(a,b){var c=a[b];return console.log(b),console.log(a),"undefined"!=typeof c?c:""}});var BootstrapSelect=Backbone.View.extend({labelAttribute:"label",valueAttribute:"value",events:{change:"onChange"},initialize:function(a){this.values=a.values,this.value=a.value,this.render()},render:function(){this.value||this.$el.append('<option class="selection"> - SELECT - </option>');for(var a in this.values){var b=this.values[a],c=b==this.value;this.$el.append('<option class="selection" '+(c?"selected":"")+' value="'+b[this.valueAttribute]+'">'+b[this.labelAttribute]+"</option>")}},onChange:function(a){this.trigger("change",this.$el.val())}});ParticleFire.Templates.Loader='<span>LOADING&nbsp;&nbsp;&nbsp;<i class="fa fa-fire fa-spin"></i></span>',ParticleFire.Templates.Loader_Profiles='<li class="active"><a>LOADING</a></li> <li><a><span><i class="fa fa-fire fa-spin"></i></span></a></li>',ParticleFire.Templates.Modal='\n<div class="modal in" tabindex="-1" role="dialog" aria-labelledby="Modal Dialog">  <div class="modal-dialog modal-lg">    <div class="modal-content">      <div class="modal-header">        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">Ã—</span></button>          <h4 class="modal-title" id="modal"><%= header %></h4>      </div>      <div class="modal-body"> </div>      <div class="modal-footer"> <div class="modal-buttons"> <button class="pull-right btn btn-primary">SAVE</button> <button class="pull-right btn btn-default">CANCEL</button> </div> </div> </div> </div> </div>',ParticleFire.Templates.ProfileTab='\n<li class="<%= classes %>" role="presentation"><a href="#<%= profile_content_id %>" aria-controls="#<%= profile_content_id %>" role="tab" data-toggle="tab"><%= name %></a></li>',ParticleFire.Templates.NoProfiles='\n<div class="well"><p>You haven\'t added any profiles yet.</p></div>',ParticleFire.Templates.TabProfileContent='\n<div role="tabpanel" class="tab-pane <%= classes %>" id="<%= profile_content_id %>"></div>',ParticleFire.Templates.Profile='\n<table id="ios" class="table table-striped">  <tbody class="io-list">    <tr>      <td class="cell-io-name active"> <i class="fa fa-gg"></i>&nbsp;&nbsp;        LOADING      </td>      <td class="cell-io-content"><span><i class="fa fa-fire fa-spin"></i></span></td>    </tr>  </tbody>  <tfoot>    <tr>      <td class="cell-io-name cell-io-new text-center">        <div class="io-new">          <div id="newIO" class="btn-new-io btn btn-primary"><i class="fa fa-plus-circle"></i>&nbsp;            I/O          </div>        </div>      </td>      <td class="cell-io-content"> </td>    </tr>  </tfoot></table>',ParticleFire.Templates.IO='\n<tr>  <td class="cell-io-name cell-io-edit active">    <i class="fa fa-gg"></i>&nbsp;&nbsp;    <%= name %>    <span class="io-edit pull-right"><i class="fa fa-pencil"></i></span>  </td>  <td id="<%= id %>" class="cell-io-content">Open/Closed</td></tr>',ParticleFire.Templates.IOEditContent='\n<form class="form-horizontal">  <div class="form-group">    <label for="io-name" class="col-sm-2 control-label">I/O Name:</label>    <div class="col-sm-10">      <input type="input" class="form-control" id="io-name" value="<%= name %>">    </div>  </div>  <div class="form-group">    <label for="io-type" class="col-sm-2 control-label">I/O Type:</label>    <div class="col-sm-10">      <select id="io-type" class="form-control io-types-select"></select>    </div>  </div>  <div class="io-type-fields">  </div></form>',ParticleFire.Templates.IOEditType_trigger='\n<div class="form-group">  <label for="io-device-name" class="col-sm-2 control-label">Device Name:</label>  <div class="col-sm-10">    <input type="input" class="form-control" id="io-device-name" value="<%= device_name %>">  </div></div><div class="form-group">  <label for="io-device-name" class="col-sm-2 control-label">Input ID:</label>  <div class="col-sm-10">    <input type="input" class="form-control" id="io-input-pin" value="<%= input_pin %>" placeholder="Example: A6">  </div></div>',ParticleFire.Templates.IOEditType_toggle='\n<div class="form-group">  <label for="io-device-name" class="col-sm-2 control-label">Device Name:</label>  <div class="col-sm-10">    <input type="input" class="form-control" id="io-device-name" value="<%= device_name %>">  </div></div><div class="form-group">  <label for="io-device-name" class="col-sm-2 control-label">Input ID:</label>  <div class="col-sm-10">    <input type="input" class="form-control" id="io-input-pin" value="<%= input_pin %>" placeholder="Example: A6">  </div></div>',ParticleFire.Models.IO=Backbone.Model.extend({types:[{value:"trigger",label:"Trigger"},{value:"toggle",label:"Toggle"},{value:"power_buttons",label:"Power Buttons"},{value:"reading",label:"Value Reading"},{value:"video",label:"Video Feed"}],initialize:function(){}}),ParticleFire.Collections.IO=Backbone.Collection.extend({model:ParticleFire.Models.IO,url:function(){return"/profiles/"+this.profile_id+"/io"},initialize:function(a){this.profile_id=a.profile_id}}),ParticleFire.Models.Profile=Backbone.Model.extend({initialize:function(){}}),ParticleFire.Collections.Profile=Backbone.Collection.extend({model:ParticleFire.Models.Profile,url:function(){return"/profiles"},initialize:function(){}}),ParticleFire.Views.Modal=Backbone.View.extend({header:"Great template",contentTemplate:_.template("Hi, How ya doin?"),modalTemplate:_.template(ParticleFire.Templates.Modal),events:{},initialize:function(a){this.render()},render:function(a){var b={};b.header=this.header,this.$content=$(this.modalTemplate(b)),this.$modalBody=this.$content.find(".modal-body"),this.$modalBody.html(this.contentTemplate(a)),this.$content.modal(),this.onRender()},onRender:function(){}}),ParticleFire.Views.ControlPanel=Backbone.View.extend({events:{"click .add-profile":"addProfile"},initialize:function(a){this.profile_id=a.profile_id,this.$profileList=this.$(".profile-list"),this.$profileListContent=this.$(".profile-tab-content"),this.collection=ParticleFire.App.profiles,this.profileViews=[],this.listenTo(this.collection,"sync",this.render),this.templates={profileTab:_.template(ParticleFire.Templates.ProfileTab),profileContent:_.template(ParticleFire.Templates.TabProfileContent)},this.$profileList.html(ParticleFire.Templates.Loader_Profiles)},render:function(){this.$profileList.html(""),this.collection.length>0?(this.profile_id||(this.profile_id=this.collection.at(0).id),this.renderAllProfiles()):this.$profileListContent.append(ParticleFire.Templates.NoProfiles)},loadProfiles:function(){this.collection.fetch()},renderAllProfiles:function(){var a=this;_.each(this.collection.models,function(b){a.renderProfile(b)})},renderProfile:function(a){var b=a.toJSON(),c="profile-"+a.id,d=b.id==this.profile_id;b.profile_content_id=c,b.classes=d?"active":"",b.active=d,this.$profileList.append(this.templates.profileTab(b)),this.$profileListContent.append(this.templates.profileContent(b));var e=new ParticleFire.Views.Profile({el:"#"+c,model:a});this.profileViews.push(e),d&&e.activate()},addProfile:function(){}}),ParticleFire.Views.IO=Backbone.View.extend({events:{"click .cell-io-edit":"editIO"},initialize:function(a){this.model=a.model,this.$parentEl=a.$parentEl,this.templates={IO:_.template(ParticleFire.Templates.IO)},this.render()},render:function(){var a=this.model.toJSON();this.el=this.templates.IO(a),this.$el=$(this.el),this.$parentEl.append(this.$el),this.delegateEvents()},editIO:function(){var a={};a.model=this.model,this.ioEditView=new ParticleFire.Views.IOEdit(a)}}),ParticleFire.Views.IOEdit=ParticleFire.Views.Modal.extend({contentTemplate:_.template(ParticleFire.Templates.IOEditContent),ioTypeTemplates:{trigger:_.template(ParticleFire.Templates.IOEditType_trigger),toggle:_.template(ParticleFire.Templates.IOEditType_toggle),power_buttons:_.template(ParticleFire.Templates.IOEditType_trigger),reading:_.template(ParticleFire.Templates.IOEditType_trigger),video:_.template(ParticleFire.Templates.IOEditType_trigger)},ioFieldDefaults:{device_name:"",input_pin:"",output_pin:""},events:{},initialize:function(a){this.model=a.model,this.headerText="New IO",this.model.id&&(this.headerText="Edit IO"),this.header='<span><i class="fa fa-gg"></i>&nbsp;&nbsp;'+this.headerText+"</span>",this.render(this.model.toJSON())},onRender:function(a){this.$ioFields=$(".modal.in .io-type-fields"),this.typesDropdown=new BootstrapSelect({el:".modal.in .io-types-select",values:this.model.types,value:this.model.get("type")}),this.typesDropdown.bind("change",this.renderIOFields,this)},renderIOFields:function(a){this.model.set({device_name:"Aragon"},{silent:!0}),this.$ioFields.html(this.ioTypeTemplates[a](this.getFieldsObj()))},getFieldsObj:function(){return $.extend({},this.ioFieldDefaults,this.model.toJSON())}}),ParticleFire.Views.Profile=Backbone.View.extend({events:{"click .add-io":"addIO"},initialize:function(a){this.model=a.model,this.active=!1,this.collection=new ParticleFire.Collections.IO([],{profile_id:this.model.id}),this.listenTo(this.collection,"sync",this.render),this.ioViews=[],this.templates={profile:_.template(ParticleFire.Templates.Profile),IO:_.template(ParticleFire.Templates.IO)},this.renderLoader()},renderLoader:function(){var a=this.model.toJSON();this.$el.html(this.templates.profile(a)),this.$IOList=this.$(".io-list")},render:function(){this.$IOList.html(""),this.collection.length>0&&this.renderAllIOs()},activate:function(){this.active=!0,this.loadIOs()},loadIOs:function(){this.collection.fetch()},renderAllIOs:function(){var a=this;_.each(this.collection.models,function(b){a.renderIO(b)})},renderIO:function(a){this.ioViews.push(new ParticleFire.Views.IO({model:a,$parentEl:this.$IOList}))},addIO:function(){}}),ParticleFire.Routers.ControlPanel=Backbone.Router.extend({routes:{"":"initRoute","control-panel":"load"},initialize:function(a){Backbone.history.start()},initRoute:function(){this.navigate("control-panel",{trigger:!0,replace:!0})},load:function(){ParticleFire.App.controlPanel.loadProfiles()}});